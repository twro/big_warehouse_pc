<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>首页</title>
    <link rel="stylesheet" href="css/ydui.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery-2.1.1.js"></script>
    <script src="js/ydui.flexible.js"></script>
    <script src="js/ydui.js"></script>
    <script src="http://api.map.baidu.com/api?v=2.0&ak=FXX6rmiwER4BmuykrxxQ3p1PWY6TQDmm"></script>
</head>
<body>
<section class="g-flexview" id="#app">
    <div class="g-scrollview">
        <div class="head-search clearfix">
            <div class="sel-area clearfix">
                <p class="sel-title">定位</p>
                <span class="sel-icon"></span>
            </div>
            <div class="search-bar">
                <span class="search-icon"></span>
                <input type="text" placeholder="搜索您想要的商品或品牌" >
                <span class="qrcode"></span>
            </div>
            <a href="javascript:;" class="msg "></a>
        </div>
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><a href="javascript:;"><img src="images/banner1.png" alt=""></a></div>
                <div class="swiper-slide"><a href="javascript:;"><img src="images/banner1.png" alt=""></a></div>
                <div class="swiper-slide"><a href="javascript:;"><img src="images/banner1.png" alt=""></a></div>
                <div class="swiper-slide"><a href="javascript:;"><img src="images/banner1.png" alt=""></a></div>
                <div class="swiper-slide"><a href="javascript:;"><img src="images/banner1.png" alt=""></a></div>
            </div>
            <!-- 如果需要分页器 -->
            <div class="swiper-pagination clearfix"></div>
        </div>

        <div class="swiper-container1">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <ul class="nav-list">
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                    </ul>
                </div>
                <div class="swiper-slide">
                    <ul class="nav-list">
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                        <li><a href=""><img src="images/list1.jpg" alt=""><p>正版奶粉</p></a></li>
                    </ul>
                </div>
            </div>
            <!-- 如果需要分页器 -->
            <div class="swiper-pagination1 clearfix"></div>
        </div>
        <!--货栈头条-->
        <div class="top-line clearfix">
            <div class="topLine-txt clearfix">
                <span class="top-icon"></span>
                <div class="txt-scroll clearfix">
                    <ul>
                        <li class="clearfix"><span class="moba">母婴</span><p class="txt-p">日本花王婴儿拉拉裤特价促销...</p></li>
                        <li class="clearfix"><span class="moba">母婴</span><p class="txt-p">日本花王婴儿拉拉裤特价促销...</p></li>
                        <li class="clearfix"><span class="moba">母婴</span><p class="txt-p">日本花王婴儿拉拉裤特价促销...</p></li>
                    </ul>
                </div>
            </div>
            <a href="" class="topLine-more"><span class="vertical-line">|</span>更多</a>
        </div>
        <div class="edge"></div>

        <!--限时秒杀-->
        <div class="sale">
           <span class="seckill"></span>
            <div class="sale-time">
                <ul>
                    <li>05</li>
                    <li>:</li>
                    <li>36</li>
                    <li>:</li>
                    <li>26</li>
                </ul>
            </div>
            <a href="" class="sale-list clearfix">
                <img src="images/milk.png" alt="" class="skill-left">
                <div class="skill-right">
                    <div class="country clearfix">
                        <span class="country-icon"></span>
                        <p class="country-txt">澳洲</p>
                    </div>
                    <p class="skill-title">【保税】新西兰爱他美Aptamil婴幼儿奶粉1段(0-6个月)</p>
                    <div class="price clearfix">
                        <p class="current-price">￥280.00起</p>
                        <p class="prime-price">￥300.00</p>
                    </div>
                </div>
            </a>
            <a href="" class="sale-list clearfix">
                <img src="images/milk.png" alt="" class="skill-left">
                <div class="skill-right">
                    <div class="country clearfix">
                        <span class="country-icon"></span>
                        <p class="country-txt">澳洲</p>
                    </div>
                    <p class="skill-title">【保税】新西兰爱他美Aptamil婴幼儿奶粉1段(0-6个月)</p>
                    <div class="price clearfix">
                        <p class="current-price">￥280.00起</p>
                        <p class="prime-price">￥300.00</p>
                    </div>
                </div>
            </a>
            <div class="see-all">
               <p>查看全部</p>
                <span class="all-icon"></span>
            </div>
            <div class="edge"></div>
        </div>


        <!--特价清仓-->
        <div class="sale">
            <span class="seckill special-price"></span>
            <a href="" class="sale-list clearfix">
                <img src="images/milk.png" alt="" class="skill-left">
                <div class="skill-right">
                    <div class="country clearfix">
                        <span class="country-icon"></span>
                        <p class="country-txt">澳洲</p>
                    </div>
                    <p class="skill-title">【保税】新西兰爱他美Aptamil婴幼儿奶粉1段(0-6个月)</p>
                    <div class="price clearfix">
                        <p class="current-price">￥280.00起</p>
                        <p class="prime-price">￥300.00</p>
                    </div>
                </div>
            </a>
            <a href="" class="sale-list clearfix">
                <img src="images/milk.png" alt="" class="skill-left">
                <div class="skill-right">
                    <div class="country clearfix">
                        <span class="country-icon"></span>
                        <p class="country-txt">澳洲</p>
                    </div>
                    <p class="skill-title">【保税】新西兰爱他美Aptamil婴幼儿奶粉1段(0-6个月)</p>
                    <div class="price clearfix">
                        <p class="current-price">￥280.00起</p>
                        <p class="prime-price">￥300.00</p>
                    </div>
                </div>
            </a>
            <div class="see-all">
                <p>查看全部</p>
                <span class="all-icon"></span>
            </div>
            <div class="edge"></div>
        </div>

        <!--今日推荐-->
        <div class="today-box" id="J_List">
            <div class="swiper-container2" >
                <div class="swiper-wrapper">
                    <div class="swiper-slide active-nav">
                        今日推荐
                    </div>
                    <div class="swiper-slide">
                        正版奶粉
                    </div>
                    <div class="swiper-slide">
                        营养保健
                    </div>
                    <div class="swiper-slide">
                        美妆个护
                    </div>
                    <div class="swiper-slide">
                        日用百货
                    </div>
                    <div class="swiper-slide">
                        日用百货
                    </div>
                </div>
            </div>
            <div id="J_ListContent">
                <div class="today-list clearfix" >
                    <a href="" class="today-list-item">
                        <img src="images/today.png" alt="">
                        <div class="today-country clearfix">
                            <span class="today-icon"></span>
                            <p class="today-country-txt">德国</p>
                        </div>
                        <p class="skill-title today-title">【澳洲直邮】澳洲A2Plati 白金版婴幼儿奶粉100g</p>
                        <div class="today-label clearfix">
                            <span class="label-public label-one">热销</span>
                            <span class="label-public label-two">官方</span>
                        </div>
                        <p class="today-price">￥280.00-360.00</p>
                    </a>
                    <a href="" class="today-list-item">
                        <img src="images/today.png" alt="">
                        <div class="today-country clearfix">
                            <span class="today-icon"></span>
                            <p class="today-country-txt">德国</p>
                        </div>
                        <p class="skill-title today-title">【澳洲直邮】澳洲A2Plati 白金版婴幼儿奶粉100g</p>
                        <div class="today-label clearfix">
                            <span class="label-public label-one">热销</span>
                            <span class="label-public label-two">官方</span>
                        </div>
                        <p class="today-price">￥280.00-360.00</p>
                    </a>
                </div>
            </div>
            <!--<p class="data-null">我是有底线的哦</p>-->
        </div>
    </div>

    <footer class="m-tabbar">
        <a href="#" class="tabbar-item tabbar-active">
            <span class="nav-icon"></span>
            <span class="tabbar-txt">首页</span>
        </a>
        <a href="#" class="tabbar-item">
            <span class="nav-icon"></span>
            <span class="tabbar-txt">分类</span>
        </a>
        <a href="#" class="tabbar-item">
            <span class="nav-icon"></span>
            <span class="tabbar-txt">进货车</span>
        </a>
        <a href="#" class="tabbar-item">
            <span class="nav-icon"></span>
            <span class="tabbar-txt">我的</span>
        </a>
    </footer>
</section>

<script src="js/vue.min.js"></script>
<script src="js/swiper.min.js"></script>
<script>
    /* 通过自定义的方法获取数据【通常是需要定义变量当前第几页page，和每页请求的记录数pageSize】 */
    var page = 1, pageSize = 10;

    $('#J_List').infiniteScroll({
        pageSize: pageSize,
        initLoad: true,
        loadingHtml: '<strong>加载中...</strong>', /* 当然也可以<img src="../img/loading.gif" /> */
        loadListFn: function () {
            var def = $.Deferred();

            /* 通过自定义的方法获取数据 */
            $.ajax({
                url: '/请求数据方法',
                dataType: 'json',
                data: { page: page, pagesize: pageSize },
                success: function (ret) {
                    /* 假设ret.list为后端返回的列表数组 */

                    /* 用你喜欢的方法将获取到的数据拼接成HTML，然后插入；*/
                    /* 建议使用模板引擎，示例使用artTemplate；https://github.com/aui/artTemplate */
                    var html = ret.list + '将数据拼接成html';
                    $('#J_ListContent').append(html);

                    /* 获取数据，并插入页面后，调用resole，并传入当前获取的记录列表集合 */
                    def.resolve(ret.list);

                    /* 页码自增1 */
                    ++page;
                }
            });

            return def.promise();
        }
    });
</script>

<script>

    var vm = new Vue({
        el:"#app",
        data:{},
        method:{
           bdLocation:function () {
               var geolocation = new BMap.Geolocation();
               geolocation.getCurrentPosition(function (r) {
                   if(this.getStatus() == BMAP_STATUS_SUCCESS){
                       lat = r.point.lat;
                       lng  = r.point.lng;
                       city= r.address.province;
                       $('.sel-title').text(r.address.city)
                   }
               })
           }
        }
    })




    var mySwiper = new Swiper ('.swiper-container', {
        loop: true,
        speed:800,
        autoplay: {
            disableOnInteraction:false,
            delay: 1500,//1秒切换一次
        },
        // 如果需要分页器
        pagination: {
            el: '.swiper-pagination',
            bulletClass: 'my-bullet',
            bulletActiveClass: 'my-bullet-active'
        }

    })
    var mySwiper1 = new Swiper ('.swiper-container1', {
        loop: true,
        speed:800,
        // 如果需要分页器
        pagination: {
            el: '.swiper-pagination1',
            bulletClass: 'my-bullet1',
            bulletActiveClass: 'my-bullet-active1'
        }

    });

    var mySwiper2 = new Swiper('.swiper-container2',{
        watchSlidesProgress : true,
        slidesPerView : 4.5,
        // slideToClickedSlide: true,
        on:{
           tap: function(){
               swiperWidth =  mySwiper2.$el[0].clientWidth
               maxTranslate =  mySwiper2.maxTranslate();
               maxWidth = -maxTranslate + swiperWidth / 2
                $(mySwiper2.slides[mySwiper2.clickedIndex]).addClass('active-nav').siblings().removeClass('active-nav');
               slide = mySwiper2.slides[mySwiper2.clickedIndex]
               slideLeft = slide.offsetLeft
               slideWidth = slide.clientWidth
               slideCenter = slideLeft + slideWidth / 2
               // 被点击slide的中心点
               mySwiper2.setTransition(300)

               if (slideCenter < swiperWidth / 2) {

                   mySwiper2.setTranslate(0)

               } else if (slideCenter > maxWidth) {

                   mySwiper2.setTranslate(maxTranslate)

               } else {

                   nowTlanslate = slideCenter - swiperWidth / 2

                   mySwiper2.setTranslate(-nowTlanslate)

               }
            }
        }
    })
    mySwiper2.$el.on('touchstart', function (e) {
        e.preventDefault() //去掉按压阴影
    })



    function headerScroll() {
        var selicon = document.querySelector('.sel-icon');
        var msg = document.querySelector('.msg');
        var scrollBox = document.querySelector('.g-scrollview');
        // 获取 导航栏
        var navDom = document.querySelector('.swiper-container');
        //  希望获取的是 从顶部 到 导航栏 底部的 距离
        var maxDistance = navDom.offsetTop + navDom.offsetHeight;

        // 获取 顶部的通栏
        var headerDom = document.querySelector('.head-search');

        // 0 为了保证默认是透明度 可以再这里 直接设置 rgba的a 为0
        // 使用js 修改的样式 会变为 行内式
        headerDom.style.backgroundColor = 'rgba(245, 23, 74,0)';

        // 2.注册 onscroll 事件 注册给谁

        scrollBox.onscroll = function () {
            // console.log('123');
            //  获取 滚动的距离 body 是通过 document 点出来的
            var scrollDistance = scrollBox.scrollTop;

            // 计算一个 0-1的百分数
            var percent = (scrollDistance / maxDistance) >1 ?1:scrollDistance / maxDistance;
             var whiteTxt= Math.floor(percent*10);
             var whiteNum =255/10;
            var rgb=(maxDistance + 4 ) / Math.ceil(percent);
             if(percent === 1){
                 selicon.className = 'white-sel';
                 msg.className = 'white-msg';
             }else{
                 selicon.className = 'sel-icon';
                 msg.className = 'msg';
             }
            // 设置 顶部通栏的透明度
            headerDom.style.backgroundColor = 'rgba(245, 23, 74,'+percent+')';

            document.querySelector('.sel-title').style.color='rgb('+whiteTxt*whiteNum+','+whiteTxt*whiteNum+','+whiteTxt*whiteNum+')';

        }

    }
    headerScroll()

    // 文字轮播
    function noticeUp(obj, top, time) {
        $(obj).animate({
            marginTop: top
        }, time, function() {
            $(this).css({
                marginTop: "0"
            }).find(":first").appendTo(this);
        })
    }
    setInterval("noticeUp('.txt-scroll ul','-" + 0.88 + "rem',800)", 4000);


    // 倒计时
    var liArr=document.querySelectorAll(".sale-time li") ;
    var timer = setInterval(getTime,1);
    function getTime(){
        var nowtime = new Date();
        var future = new Date("2018/11/22 14:32:50");
        var timeSum = future.getTime() - nowtime.getTime();
        var hour = parseInt(timeSum/1000/60/60);
        var minu = parseInt(timeSum/1000/60%60);
        var sec = parseInt(timeSum/1000%60);
        hour=hour<10?"0"+hour:hour;
        minu=minu<10?"0"+minu:minu;
        sec=sec<10?"0"+sec:sec;
        if(timeSum<0){
            liArr[0].innerHTML= "00";
            liArr[2].innerHTML= "00";
            liArr[4].innerHTML= "00";
            clearInterval(timer);
            return;
        }
        liArr[0].innerHTML=hour;
        liArr[2].innerHTML=minu;
        liArr[4].innerHTML=sec;
    }
    getTime()
</script>
</body>
</html>
